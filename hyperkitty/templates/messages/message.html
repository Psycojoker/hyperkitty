{% load storm %}
{% load gravatar %}

<div class="email_header">
	<div class="email_date inline-block pull-right">
		{% ifchanged %}
		<span class="date">
			{{email.date|date:"l, j F"}}
			{% if unfolded %}
			{{email.date|date:"Y"}}
			{% endif %}
		</span>
		{% endifchanged %}
		<span class="time">{{email.date|date:"H:i:s e"}}</span>
		<br />
	</div>
	{% gravatar_img_for_email email.email 40 %}
	<div class="email_author inline-block">
		<span class="name"> <a href="{% url message_index mlist_fqdn=list_address, hashid=email.message_id_hash %}">{{email.sender_name}}</a> </span>
		<br />
		<span class="rank">
        {% if settings.USE_MOCKUPS == True %}
            Rank 8
        {% else %}
            &nbsp;
        {% endif %}
		</span>
	</div>
</div>

{% if unfolded %}
<div class="first_email_body">
{% else %}
<div class="email_body">
{% endif %}
{{email.content}}
</div>

{% if unfolded and email.attachments|count %}
<p class="attachments">Attachments:</p>
<ul class="attachments-list">
{% for attachment in email.attachments %}
    <li><a href="{% url message_attachment mlist_fqdn=list_address, hashid=email.message_id_hash, counter=attachment.counter, filename=attachment.name %}">{{attachment.name}}</a>
        ({{attachment.content_type}} &mdash; {{attachment.size|filesizeformat}})
    </li>
{% endfor %}
</ul>
{% endif %}

<ul class="email_info inline" messageid="{{email.message_id_hash}}">
{% if settings.USE_MOCKUPS == True %}
	<li class="likestatus neutral">
		+{{email.likes}}/-{{email.dislikes}}
	</li>
	<li class="voteup">
		<a class="youlike" href="#like">Like</a>
	</li>
	<li class="votedown">
		<a class="youdislike" href="#dislike">Dislike</a>
	</li>
{% endif %}
{% if not unfolded and email.attachments|count %}
    <li class="attachments">
        <a href="#attachments">{{ email.attachments|count }} attachment(s)</a>
        <ul class="attachments-list">
        {% for attachment in email.attachments %}
            <li><a href="{% url message_attachment mlist_fqdn=list_address, hashid=email.message_id_hash, counter=attachment.counter, filename=attachment.name %}">{{attachment.name}}</a>
                ({{attachment.content_type}} &mdash; {{attachment.size|filesizeformat}})
            </li>
        {% endfor %}
        </ul>
    </li>
{% endif %}
</ul>


